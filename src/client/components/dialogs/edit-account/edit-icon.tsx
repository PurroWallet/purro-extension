import { useState, useEffect } from 'react';
import useEditAccountStore from '@/client/hooks/use-edit-account-store';
import {
  Button,
  DialogContent,
  DialogFooter,
  DialogHeader,
  DialogWrapper,
} from '@/client/components/ui';
import useWallet from '@/client/hooks/use-wallet';
import useWalletStore from '@/client/hooks/use-wallet-store';
import {
  getHLProfileByAddress,
  HLProfile,
} from '@/client/services/hyperliquid-name-api';
import { HlNameIcon } from '@/assets/icon-component/hl-name-icon';

// Constants for easy customization
const ICON_SELECTION_TYPES = {
  EMOJI: 'emoji',
  HL_AVATAR: 'hl_avatar',
} as const;

const SELECTION_TAB_LABELS = {
  EMOJI: 'Emoji Icons',
  HL_AVATAR: 'HL Avatar',
} as const;

const emojiCategories = {
  'Smileys & People': [
    'ðŸ˜€',
    'ðŸ˜ƒ',
    'ðŸ˜„',
    'ðŸ˜',
    'ðŸ˜†',
    'ðŸ˜…',
    'ðŸ¤£',
    'ðŸ˜‚',
    'ðŸ™‚',
    'ðŸ™ƒ',
    'ðŸ˜‰',
    'ðŸ˜Š',
    'ðŸ˜‡',
    'ðŸ¥°',
    'ðŸ˜',
    'ðŸ¤©',
    'ðŸ˜˜',
    'ðŸ˜—',
    'ðŸ˜š',
    'ðŸ˜™',
    'ðŸ˜‹',
    'ðŸ˜›',
    'ðŸ˜œ',
    'ðŸ¤ª',
    'ðŸ˜',
    'ðŸ¤‘',
    'ðŸ¤—',
    'ðŸ¤­',
    'ðŸ¤«',
    'ðŸ¤”',
    'ðŸ¤',
    'ðŸ¤¨',
    'ðŸ˜',
    'ðŸ˜‘',
    'ðŸ˜¶',
    'ðŸ˜',
    'ðŸ˜’',
    'ðŸ™„',
    'ðŸ˜¬',
    'ðŸ¤¥',
    'ðŸ˜”',
    'ðŸ˜ª',
    'ðŸ¤¤',
    'ðŸ˜´',
    'ðŸ˜·',
    'ðŸ¤’',
    'ðŸ¤•',
    'ðŸ¤¢',
    'ðŸ¤®',
    'ðŸ¤§',
    'ðŸ¥µ',
    'ðŸ¥¶',
    'ðŸ¥´',
    'ðŸ˜µ',
    'ðŸ¤¯',
    'ðŸ¤ ',
    'ðŸ¥³',
    'ðŸ˜Ž',
    'ðŸ¤“',
    'ðŸ§',
    'ðŸ‘¶',
    'ðŸ§’',
    'ðŸ‘¦',
    'ðŸ‘§',
    'ðŸ§‘',
    'ðŸ‘±',
    'ðŸ‘¨',
    'ðŸ§”',
    'ðŸ‘©',
    'ðŸ§“',
    'ðŸ‘´',
    'ðŸ‘µ',
    'ðŸ™',
    'ðŸ™Ž',
    'ðŸ™…',
    'ðŸ™†',
    'ðŸ’',
    'ðŸ™‹',
    'ðŸ§',
    'ðŸ™‡',
    'ðŸ¤¦',
    'ðŸ¤·',
    'ðŸ‘®',
    'ðŸ•µ',
    'ðŸ’‚',
    'ðŸ‘·',
    'ðŸ¤´',
    'ðŸ‘¸',
    'ðŸ‘³',
    'ðŸ‘²',
    'ðŸ§•',
    'ðŸ¤µ',
    'ðŸ‘°',
    'ðŸ¤°',
    'ðŸ¤±',
    'ðŸ‘¼',
    'ðŸŽ…',
    'ðŸ¤¶',
    'ðŸ¦¸',
    'ðŸ¦¹',
    'ðŸ§™',
    'ðŸ§š',
    'ðŸ§›',
    'ðŸ§œ',
    'ðŸ§',
    'ðŸ§ž',
    'ðŸ§Ÿ',
    'ðŸ’†',
    'ðŸ’‡',
    'ðŸš¶',
    'ðŸƒ',
    'ðŸ’ƒ',
    'ðŸ•º',
    'ðŸ•´',
    'ðŸ‘¯',
    'ðŸ§–',
    'ðŸ§—',
    'ðŸ¤º',
    'ðŸ‡',
    'â›·',
    'ðŸ‚',
    'ðŸŒ',
    'ðŸ„',
    'ðŸš£',
    'ðŸŠ',
    'â›¹',
    'ðŸ‹',
    'ðŸš´',
    'ðŸšµ',
    'ðŸ¤¸',
    'ðŸ¤¼',
    'ðŸ¤½',
    'ðŸ¤¾',
    'ðŸ¤¹',
    'ðŸ§˜',
    'ðŸ›€',
    'ðŸ›Œ',
  ],
  'Animals & Nature': [
    'ðŸ¶',
    'ðŸ±',
    'ðŸ­',
    'ðŸ¹',
    'ðŸ°',
    'ðŸ¦Š',
    'ðŸ»',
    'ðŸ¼',
    'ðŸ¨',
    'ðŸ¯',
    'ðŸ¦',
    'ðŸ®',
    'ðŸ·',
    'ðŸ½',
    'ðŸ¸',
    'ðŸµ',
    'ðŸ™ˆ',
    'ðŸ™‰',
    'ðŸ™Š',
    'ðŸ’',
    'ðŸ”',
    'ðŸ§',
    'ðŸ¦',
    'ðŸ¤',
    'ðŸ£',
    'ðŸ¥',
    'ðŸ¦†',
    'ðŸ¦…',
    'ðŸ¦‰',
    'ðŸ¦‡',
    'ðŸº',
    'ðŸ—',
    'ðŸ´',
    'ðŸ¦„',
    'ðŸ',
    'ðŸ›',
    'ðŸ¦‹',
    'ðŸŒ',
    'ðŸž',
    'ðŸœ',
    'ðŸ¦Ÿ',
    'ðŸ¦—',
    'ðŸ•·',
    'ðŸ•¸',
    'ðŸ¦‚',
    'ðŸ¢',
    'ðŸ',
    'ðŸ¦Ž',
    'ðŸ¦–',
    'ðŸ¦•',
    'ðŸ™',
    'ðŸ¦‘',
    'ðŸ¦',
    'ðŸ¦ž',
    'ðŸ¦€',
    'ðŸ¡',
    'ðŸ ',
    'ðŸŸ',
    'ðŸ¬',
    'ðŸ³',
    'ðŸ‹',
    'ðŸ¦ˆ',
    'ðŸŠ',
    'ðŸ…',
    'ðŸ†',
    'ðŸ¦“',
    'ðŸ¦',
    'ðŸ¦§',
    'ðŸ˜',
    'ðŸ¦›',
    'ðŸ¦',
    'ðŸª',
    'ðŸ«',
    'ðŸ¦’',
    'ðŸ¦˜',
    'ðŸƒ',
    'ðŸ‚',
    'ðŸ„',
    'ðŸŽ',
    'ðŸ–',
    'ðŸ',
    'ðŸ‘',
    'ðŸ¦™',
    'ðŸ',
    'ðŸ¦Œ',
    'ðŸ•',
    'ðŸ©',
    'ðŸ¦®',
    'ðŸ•â€ðŸ¦º',
    'ðŸˆ',
    'ðŸ“',
    'ðŸ¦ƒ',
    'ðŸ¦š',
    'ðŸ¦œ',
    'ðŸ¦¢',
    'ðŸ¦©',
    'ðŸ•Š',
    'ðŸ‡',
    'ðŸ¦',
    'ðŸ¦¨',
    'ðŸŒ²',
    'ðŸŒ³',
    'ðŸŒ´',
    'ðŸŒµ',
    'ðŸŒ¶',
    'ðŸ„',
    'ðŸŒ¾',
    'ðŸ’',
    'ðŸŒ·',
    'ðŸŒ¹',
    'ðŸ¥€',
    'ðŸŒº',
    'ðŸŒ¸',
    'ðŸŒ¼',
    'ðŸŒ»',
    'ðŸŒž',
    'ðŸŒ',
    'ðŸŒ›',
    'ðŸŒœ',
    'ðŸŒš',
    'ðŸŒ•',
    'ðŸŒ–',
    'ðŸŒ—',
    'ðŸŒ˜',
    'ðŸŒ‘',
    'ðŸŒ’',
    'ðŸŒ“',
    'ðŸŒ”',
    'ðŸŒ™',
    'ðŸŒŽ',
    'ðŸŒ',
    'ðŸŒ',
    'ðŸª',
    'ðŸ’«',
    'â­',
    'ðŸŒŸ',
    'âœ¨',
    'âš¡',
    'â˜„',
    'ðŸ’¥',
  ],
  'Food & Drink': [
    'ðŸ',
    'ðŸŽ',
    'ðŸ',
    'ðŸŠ',
    'ðŸ‹',
    'ðŸŒ',
    'ðŸ‰',
    'ðŸ‡',
    'ðŸ“',
    'ðŸ«',
    'ðŸˆ',
    'ðŸ’',
    'ðŸ‘',
    'ðŸ¥­',
    'ðŸ',
    'ðŸ¥¥',
    'ðŸ¥',
    'ðŸ…',
    'ðŸ†',
    'ðŸ¥‘',
    'ðŸ¥¦',
    'ðŸ¥¬',
    'ðŸ¥’',
    'ðŸŒ¶',
    'ðŸ«‘',
    'ðŸŒ½',
    'ðŸ¥•',
    'ðŸ«’',
    'ðŸ§„',
    'ðŸ§…',
    'ðŸ¥”',
    'ðŸ ',
    'ðŸ¥',
    'ðŸ¥¯',
    'ðŸž',
    'ðŸ¥–',
    'ðŸ¥¨',
    'ðŸ§€',
    'ðŸ¥š',
    'ðŸ³',
    'ðŸ§ˆ',
    'ðŸ¥ž',
    'ðŸ§‡',
    'ðŸ¥“',
    'ðŸ¥©',
    'ðŸ—',
    'ðŸ–',
    'ðŸ¦´',
    'ðŸŒ­',
    'ðŸ”',
    'ðŸŸ',
    'ðŸ•',
    'ðŸ«“',
    'ðŸ¥ª',
    'ðŸ¥™',
    'ðŸ§†',
    'ðŸŒ®',
    'ðŸŒ¯',
    'ðŸ«”',
    'ðŸ¥—',
    'ðŸ¥˜',
    'ðŸ«•',
    'ðŸ¥«',
    'ðŸ',
    'ðŸœ',
    'ðŸ²',
    'ðŸ›',
    'ðŸ£',
    'ðŸ±',
    'ðŸ¥Ÿ',
    'ðŸ¦ª',
    'ðŸ¤',
    'ðŸ™',
    'ðŸš',
    'ðŸ˜',
    'ðŸ¥',
    'ðŸ¥ ',
    'ðŸ¥®',
    'ðŸ¢',
    'ðŸ¡',
    'ðŸ§',
    'ðŸ¨',
    'ðŸ¦',
    'ðŸ¥§',
    'ðŸ§',
    'ðŸ°',
    'ðŸŽ‚',
    'ðŸ®',
    'ðŸ­',
    'ðŸ¬',
    'ðŸ«',
    'ðŸ¿',
    'ðŸ©',
    'ðŸª',
    'ðŸŒ°',
    'ðŸ¥œ',
    'ðŸ¯',
    'ðŸ¥›',
    'ðŸ¼',
    'â˜•',
    'ðŸ«–',
    'ðŸµ',
    'ðŸ§ƒ',
    'ðŸ¥¤',
    'ðŸ¶',
    'ðŸº',
    'ðŸ»',
    'ðŸ¥‚',
    'ðŸ·',
    'ðŸ¥ƒ',
    'ðŸ¸',
    'ðŸ¹',
    'ðŸ§‰',
    'ðŸ¾',
    'ðŸ§Š',
    'ðŸ¥„',
    'ðŸ´',
    'ðŸ½',
    'ðŸ¥£',
    'ðŸ¥¡',
  ],
  'Activities & Sports': [
    'âš½',
    'ðŸ€',
    'ðŸˆ',
    'âš¾',
    'ðŸ¥Ž',
    'ðŸŽ¾',
    'ðŸ',
    'ðŸ‰',
    'ðŸ¥',
    'ðŸŽ±',
    'ðŸª€',
    'ðŸ“',
    'ðŸ¸',
    'ðŸ’',
    'ðŸ‘',
    'ðŸ¥',
    'ðŸ',
    'ðŸªƒ',
    'ðŸ¥…',
    'â›³',
    'ðŸª',
    'ðŸ¹',
    'ðŸŽ£',
    'ðŸ¤¿',
    'ðŸ¥Š',
    'ðŸ¥‹',
    'ðŸŽ½',
    'ðŸ›¹',
    'ðŸ›·',
    'â›¸',
    'ï¿½ï¿½',
    'ðŸŽ¿',
    'â›·',
    'ðŸ‚',
    'ðŸª‚',
    'ðŸ‹',
    'ðŸ¤¸',
    'ðŸ¤º',
    'ðŸ¤¾',
    'ðŸŒ',
    'ðŸ‡',
    'ðŸ§˜',
    'ðŸ„',
    'ðŸŠ',
    'ðŸ¤½',
    'ðŸš£',
    'ðŸ§—',
    'ðŸšµ',
    'ðŸš´',
    'ðŸ†',
    'ðŸ¥‡',
    'ðŸ¥ˆ',
    'ðŸ¥‰',
    'ðŸ…',
    'ðŸŽ–',
    'ðŸµ',
    'ðŸŽ—',
    'ðŸŽ«',
    'ðŸŽŸ',
    'ðŸŽª',
    'ðŸ¤¹',
    'ðŸŽ­',
    'ðŸ©°',
    'ðŸŽ¨',
    'ðŸŽ¬',
    'ðŸŽ¤',
    'ðŸŽ§',
    'ðŸŽ¼',
    'ðŸŽµ',
    'ðŸŽ¶',
    'ðŸ¥',
    'ðŸª˜',
    'ðŸŽ¹',
    'ðŸŽ·',
    'ðŸŽº',
    'ðŸŽ¸',
    'ðŸª•',
    'ðŸŽ»',
    'ðŸŽ²',
    'â™ ',
    'â™¥',
    'â™¦',
    'â™£',
    'â™Ÿ',
    'ðŸƒ',
    'ðŸ€„',
    'ðŸŽ´',
    'ðŸŽ¯',
    'ðŸŽ³',
    'ðŸŽ®',
    'ðŸ•¹',
    'ðŸŽ°',
    'ðŸ§©',
  ],
  'Travel & Places': [
    'ðŸš—',
    'ðŸš•',
    'ðŸš™',
    'ðŸšŒ',
    'ðŸšŽ',
    'ðŸŽ',
    'ðŸš“',
    'ðŸš‘',
    'ðŸš’',
    'ðŸš',
    'ðŸ›»',
    'ðŸšš',
    'ðŸš›',
    'ðŸšœ',
    'ðŸ',
    'ðŸ›µ',
    'ðŸš²',
    'ðŸ›´',
    'ðŸ›¹',
    'ðŸ›¼',
    'ðŸš',
    'ðŸ›¸',
    'âœˆ',
    'ðŸ›©',
    'ðŸ›«',
    'ðŸ›¬',
    'ðŸª‚',
    'ðŸ’º',
    'ðŸš€',
    'ðŸ›°',
    'ðŸš‰',
    'ðŸšž',
    'ðŸš',
    'ðŸš„',
    'ðŸš…',
    'ðŸšˆ',
    'ðŸš‚',
    'ðŸš†',
    'ðŸš‡',
    'ðŸšŠ',
    'ðŸšŸ',
    'ðŸš ',
    'ðŸš¡',
    'â›´',
    'ðŸ›¥',
    'ðŸš¤',
    'â›µ',
    'ðŸ›¶',
    'ðŸš£',
    'ðŸ›³',
    'âš“',
    'â›½',
    'ðŸš§',
    'ðŸš¨',
    'ðŸš¥',
    'ðŸš¦',
    'ðŸ›‘',
    'ðŸš',
    'ðŸ—º',
    'ðŸ—¿',
    'ðŸ—½',
    'ðŸ—¼',
    'ðŸ°',
    'ðŸ¯',
    'ðŸŸ',
    'ðŸŽ¡',
    'ðŸŽ¢',
    'ðŸŽ ',
    'â›²',
    'â›±',
    'ðŸ–',
    'ðŸ',
    'ðŸœ',
    'ðŸŒ‹',
    'â›°',
    'ðŸ”',
    'ðŸ—»',
    'ðŸ•',
    'â›º',
    'ðŸ›–',
    'ðŸ ',
    'ðŸ¡',
    'ðŸ˜',
    'ðŸš',
    'ðŸ—',
    'ðŸ­',
    'ðŸ¢',
    'ðŸ¬',
    'ðŸ£',
    'ðŸ¤',
    'ðŸ¥',
    'ðŸ¦',
    'ðŸ¨',
    'ðŸª',
    'ðŸ«',
    'ðŸ©',
    'ðŸ’’',
    'ðŸ›',
    'â›ª',
    'ðŸ•Œ',
    'ðŸ›•',
    'ðŸ•',
    'â›©',
    'ðŸ•‹',
    'â›²',
    'â›±',
    'ðŸŒ',
    'ðŸŒƒ',
    'ðŸ™',
    'ðŸŒ„',
    'ðŸŒ…',
    'ðŸŒ†',
    'ðŸŒ‡',
    'ðŸŒ‰',
    'â™¨',
    'ðŸŽ†',
    'ðŸŽ‡',
    'ðŸŒŒ',
    'ðŸŽ‘',
  ],
  'Objects & Symbols': [
    'âŒš',
    'ðŸ“±',
    'ðŸ“²',
    'ðŸ’»',
    'âŒ¨',
    'ðŸ–¥',
    'ðŸ–¨',
    'ðŸ–±',
    'ðŸ–²',
    'ðŸ•¹',
    'ðŸ—œ',
    'ðŸ’½',
    'ðŸ’¾',
    'ðŸ’¿',
    'ðŸ“€',
    'ðŸ“¼',
    'ðŸ“·',
    'ðŸ“¸',
    'ðŸ“¹',
    'ðŸŽ¥',
    'ðŸ“½',
    'ðŸŽž',
    'ðŸ“ž',
    'â˜Ž',
    'ðŸ“Ÿ',
    'ðŸ“ ',
    'ðŸ“º',
    'ðŸ“»',
    'ðŸŽ™',
    'ðŸŽš',
    'ðŸŽ›',
    'ðŸ§­',
    'â±',
    'â²',
    'â°',
    'ðŸ•°',
    'âŒ›',
    'â³',
    'ðŸ“¡',
    'ðŸ”‹',
    'ðŸ”Œ',
    'ðŸ’¡',
    'ðŸ”¦',
    'ðŸ•¯',
    'ðŸª”',
    'ðŸ§¯',
    'ðŸ›¢',
    'ðŸ’¸',
    'ðŸ’µ',
    'ðŸ’´',
    'ðŸ’¶',
    'ðŸ’·',
    'ðŸª™',
    'ðŸ’°',
    'ðŸ’³',
    'ðŸ’Ž',
    'âš–',
    'ðŸªœ',
    'ðŸ§°',
    'ðŸ”§',
    'ðŸ”¨',
    'âš’',
    'ðŸ› ',
    'â›',
    'ðŸª“',
    'ðŸªš',
    'ðŸ”©',
    'âš™',
    'ðŸª¤',
    'ðŸ§±',
    'â›“',
    'ðŸ§²',
    'ðŸ”«',
    'ðŸ’£',
    'ðŸ§¨',
    'ðŸª“',
    'ðŸ”ª',
    'ðŸ—¡',
    'âš”',
    'ðŸ›¡',
    'ðŸš¬',
    'âš°',
    'ðŸª¦',
    'âš±',
    'ðŸº',
    'ðŸ”®',
    'ðŸ“¿',
    'ðŸ§¿',
    'ðŸ’ˆ',
    'âš—',
    'ðŸ”­',
    'ðŸ”¬',
    'ðŸ•³',
    'ðŸ©¹',
    'ðŸ©º',
    'ðŸ’Š',
    'ðŸ’‰',
    'ðŸ©¸',
    'ðŸ§¬',
    'ðŸ¦ ',
    'ðŸ§«',
    'ðŸ§ª',
    'ðŸŒ¡',
    'ðŸ§¹',
    'ðŸ§º',
    'ðŸ§»',
    'ðŸš½',
    'ðŸš°',
    'ðŸš¿',
    'ðŸ›',
    'ðŸ›€',
    'ðŸ§´',
    'ðŸ§·',
    'ðŸ§¸',
    'ðŸ§µ',
    'ðŸª¡',
    'ðŸ§¶',
    'ðŸª¢',
    'ðŸ‘“',
    'ðŸ•¶',
    'ðŸ¥½',
    'ðŸ¥¼',
    'ðŸ¦º',
    'ðŸ‘”',
    'ðŸ‘•',
    'ðŸ‘–',
    'ðŸ§£',
    'ðŸ§¤',
    'ðŸ§¥',
    'ðŸ§¦',
    'ðŸ‘—',
    'ðŸ‘˜',
    'ðŸ¥»',
    'ðŸ©±',
    'ðŸ©²',
    'ðŸ©³',
    'ðŸ‘™',
    'ðŸ‘š',
    'ðŸ‘›',
    'ðŸ‘œ',
    'ðŸ‘',
    'ðŸ›',
    'ðŸŽ’',
    'ðŸ©´',
    'ðŸ‘ž',
    'ðŸ‘Ÿ',
    'ðŸ¥¾',
    'ðŸ¥¿',
    'ðŸ‘ ',
    'ðŸ‘¡',
    'ðŸ©°',
    'ðŸ‘¢',
    'ðŸ‘‘',
    'ðŸ‘’',
    'ðŸŽ©',
    'ðŸŽ“',
    'ðŸ§¢',
    'ðŸª–',
    'â›‘',
    'ðŸ“¿',
    'ðŸ’„',
    'ðŸ’',
    'ðŸ’Ž',
    'ðŸ”‡',
    'ðŸ”ˆ',
    'ðŸ”‰',
    'ðŸ”Š',
    'ðŸ“¢',
    'ðŸ“£',
    'ðŸ“¯',
    'ðŸ””',
    'ðŸ”•',
    'ðŸŽ¼',
    'ðŸŽµ',
    'ðŸŽ¶',
    'ðŸŽ™',
    'ðŸŽš',
    'ðŸŽ›',
    'ðŸŽ¤',
    'ðŸŽ§',
    'ðŸ“»',
    'ðŸŽ·',
    'ðŸª—',
    'ðŸŽ¸',
    'ðŸŽ¹',
    'ðŸŽº',
    'ðŸŽ»',
    'ðŸª•',
    'ðŸ¥',
    'ðŸª˜',
    'ðŸ“±',
    'ðŸ“²',
    'â˜Ž',
    'ðŸ“ž',
    'ðŸ“Ÿ',
    'ðŸ“ ',
    'ðŸ”‹',
    'ðŸ”Œ',
    'ðŸ’»',
    'ðŸ–¥',
    'ðŸ–¨',
    'âŒ¨',
    'ðŸ–±',
    'ðŸ–²',
    'ðŸ’½',
    'ðŸ’¾',
    'ðŸ’¿',
    'ðŸ“€',
    'ðŸ§®',
    'ðŸŽ¥',
    'ðŸŽž',
    'ðŸ“½',
    'ðŸŽ¬',
    'ðŸ“º',
    'ðŸ“·',
    'ðŸ“¸',
    'ðŸ“¹',
    'ðŸ“¼',
    'ðŸ”',
    'ðŸ”Ž',
    'ðŸ•¯',
    'ðŸ’¡',
    'ðŸ”¦',
    'ðŸ®',
    'ðŸª”',
    'ðŸ“”',
    'ðŸ“•',
    'ðŸ“–',
    'ðŸ“—',
    'ðŸ“˜',
    'ðŸ“™',
    'ðŸ“š',
    'ðŸ““',
    'ðŸ“’',
    'ðŸ“ƒ',
    'ðŸ“œ',
    'ðŸ“„',
    'ðŸ“°',
    'ðŸ—ž',
    'ðŸ“‘',
    'ðŸ”–',
    'ðŸ·',
    'ðŸ’°',
    'ðŸª™',
    'ðŸ’´',
    'ðŸ’µ',
    'ðŸ’¶',
    'ðŸ’·',
    'ðŸ’¸',
    'ðŸ’³',
    'ðŸ§¾',
    'ðŸ’¹',
    'âœ‰',
    'ðŸ“§',
    'ðŸ“¨',
    'ðŸ“©',
    'ðŸ“¤',
    'ðŸ“¥',
    'ðŸ“¦',
    'ðŸ“«',
    'ðŸ“ª',
    'ðŸ“¬',
    'ðŸ“­',
    'ðŸ“®',
    'ðŸ—³',
    'âœ',
    'âœ’',
    'ðŸ–‹',
    'ðŸ–Š',
    'ðŸ–Œ',
    'ðŸ–',
    'ðŸ“',
    'ðŸ’¼',
    'ðŸ“',
    'ðŸ“‚',
    'ðŸ—‚',
    'ðŸ“…',
    'ðŸ“†',
    'ðŸ—’',
    'ðŸ—“',
    'ðŸ“‡',
    'ðŸ“ˆ',
    'ðŸ“‰',
    'ðŸ“Š',
    'ðŸ“‹',
    'ðŸ“Œ',
    'ðŸ“',
    'ðŸ“Ž',
    'ðŸ–‡',
    'ðŸ“',
    'ðŸ“',
    'âœ‚',
    'ðŸ—ƒ',
    'ðŸ—„',
    'ðŸ—‘',
    'ðŸ”’',
    'ðŸ”“',
    'ðŸ”',
    'ðŸ”',
    'ðŸ”‘',
    'ðŸ—',
    'ðŸ”¨',
    'ðŸª“',
    'â›',
    'âš’',
    'ðŸ› ',
    'ðŸ—¡',
    'âš”',
    'ðŸ”«',
    'ðŸªƒ',
    'ðŸ¹',
    'ðŸ›¡',
    'ðŸªš',
    'ðŸ”§',
    'ðŸª›',
    'ðŸ”©',
    'âš™',
    'ðŸ—œ',
    'âš–',
    'ðŸ¦¯',
    'ðŸ”—',
    'â›“',
    'ðŸª',
    'ðŸ§°',
    'ðŸ§²',
    'ðŸªœ',
    'âš—',
    'ðŸ§ª',
    'ðŸ§«',
    'ðŸ§¬',
    'ðŸ”¬',
    'ðŸ”­',
    'ðŸ“¡',
    'ðŸ’‰',
    'ðŸ©¸',
    'ðŸ’Š',
    'ðŸ©¹',
    'ðŸ©º',
    'ðŸŒ¡',
  ],
  'Flags & Countries': [
    'ðŸ',
    'ðŸš©',
    'ðŸŽŒ',
    'ðŸ´',
    'ðŸ³',
    'ðŸ³â€ðŸŒˆ',
    'ðŸ³â€âš§',
    'ðŸ´â€â˜ ',
    'ðŸ‡¦ðŸ‡¨',
    'ðŸ‡¦ðŸ‡©',
    'ðŸ‡¦ðŸ‡ª',
    'ðŸ‡¦ðŸ‡«',
    'ðŸ‡¦ðŸ‡¬',
    'ðŸ‡¦ðŸ‡®',
    'ðŸ‡¦ðŸ‡±',
    'ðŸ‡¦ðŸ‡²',
    'ðŸ‡¦ðŸ‡´',
    'ðŸ‡¦ðŸ‡¶',
    'ðŸ‡¦ðŸ‡·',
    'ðŸ‡¦ðŸ‡¸',
    'ðŸ‡¦ðŸ‡¹',
    'ðŸ‡¦ðŸ‡º',
    'ðŸ‡¦ðŸ‡¼',
    'ðŸ‡¦ðŸ‡½',
    'ðŸ‡¦ðŸ‡¿',
    'ðŸ‡§ðŸ‡¦',
    'ðŸ‡§ðŸ‡§',
    'ðŸ‡§ðŸ‡©',
    'ðŸ‡§ðŸ‡ª',
    'ðŸ‡§ðŸ‡«',
    'ðŸ‡§ðŸ‡¬',
    'ðŸ‡§ðŸ‡­',
    'ðŸ‡§ðŸ‡®',
    'ðŸ‡§ðŸ‡¯',
    'ðŸ‡§ðŸ‡±',
    'ðŸ‡§ðŸ‡²',
    'ðŸ‡§ðŸ‡³',
    'ðŸ‡§ðŸ‡´',
    'ðŸ‡§ðŸ‡¶',
    'ðŸ‡§ðŸ‡·',
    'ðŸ‡§ðŸ‡¸',
    'ðŸ‡§ðŸ‡¹',
    'ðŸ‡§ðŸ‡»',
    'ðŸ‡§ðŸ‡¼',
    'ðŸ‡§ðŸ‡¾',
    'ðŸ‡§ðŸ‡¿',
    'ðŸ‡¨ðŸ‡¦',
    'ðŸ‡¨ðŸ‡¨',
    'ðŸ‡¨ðŸ‡©',
    'ðŸ‡¨ðŸ‡«',
    'ðŸ‡¨ðŸ‡¬',
    'ðŸ‡¨ðŸ‡­',
    'ðŸ‡¨ðŸ‡®',
    'ðŸ‡¨ðŸ‡°',
    'ðŸ‡¨ðŸ‡±',
    'ðŸ‡¨ðŸ‡²',
    'ðŸ‡¨ðŸ‡³',
    'ðŸ‡¨ðŸ‡´',
    'ðŸ‡¨ðŸ‡µ',
    'ðŸ‡¨ðŸ‡·',
    'ðŸ‡¨ðŸ‡º',
    'ðŸ‡¨ðŸ‡»',
    'ðŸ‡¨ðŸ‡¼',
    'ðŸ‡¨ðŸ‡½',
    'ðŸ‡¨ðŸ‡¾',
    'ðŸ‡¨ðŸ‡¿',
    'ðŸ‡©ðŸ‡ª',
    'ðŸ‡©ðŸ‡¬',
    'ðŸ‡©ðŸ‡¯',
    'ðŸ‡©ðŸ‡°',
    'ðŸ‡©ðŸ‡²',
    'ðŸ‡©ðŸ‡´',
    'ðŸ‡©ðŸ‡¿',
    'ðŸ‡ªðŸ‡¦',
    'ðŸ‡ªðŸ‡¨',
    'ðŸ‡ªðŸ‡ª',
    'ðŸ‡ªðŸ‡¬',
    'ðŸ‡ªðŸ‡­',
    'ðŸ‡ªðŸ‡·',
    'ðŸ‡ªðŸ‡¸',
    'ðŸ‡ªðŸ‡¹',
    'ðŸ‡ªðŸ‡º',
    'ðŸ‡«ðŸ‡®',
    'ðŸ‡«ðŸ‡¯',
    'ðŸ‡«ðŸ‡°',
    'ðŸ‡«ðŸ‡²',
    'ðŸ‡«ðŸ‡´',
    'ðŸ‡«ðŸ‡·',
    'ðŸ‡¬ðŸ‡¦',
    'ðŸ‡¬ðŸ‡§',
    'ðŸ‡¬ðŸ‡©',
    'ðŸ‡¬ðŸ‡ª',
    'ðŸ‡¬ðŸ‡«',
    'ðŸ‡¬ðŸ‡¬',
    'ðŸ‡¬ðŸ‡­',
    'ðŸ‡¬ðŸ‡®',
    'ðŸ‡¬ðŸ‡±',
    'ðŸ‡¬ðŸ‡²',
    'ðŸ‡¬ðŸ‡³',
    'ðŸ‡¬ðŸ‡µ',
    'ðŸ‡¬ðŸ‡¶',
    'ðŸ‡¬ðŸ‡·',
    'ðŸ‡¬ðŸ‡¸',
    'ðŸ‡¬ðŸ‡¹',
    'ðŸ‡¬ðŸ‡º',
    'ðŸ‡¬ðŸ‡¼',
    'ðŸ‡¬ðŸ‡¾',
    'ðŸ‡­ðŸ‡°',
    'ðŸ‡­ðŸ‡²',
    'ðŸ‡­ðŸ‡³',
    'ðŸ‡­ðŸ‡·',
    'ðŸ‡­ðŸ‡¹',
    'ðŸ‡­ðŸ‡º',
    'ðŸ‡®ðŸ‡¨',
    'ðŸ‡®ðŸ‡©',
    'ðŸ‡®ðŸ‡ª',
    'ðŸ‡®ðŸ‡±',
    'ðŸ‡®ðŸ‡²',
    'ðŸ‡®ðŸ‡³',
    'ðŸ‡®ðŸ‡´',
    'ðŸ‡®ðŸ‡¶',
    'ðŸ‡®ðŸ‡·',
    'ðŸ‡®ðŸ‡¸',
    'ðŸ‡®ðŸ‡¹',
    'ðŸ‡¯ðŸ‡ª',
    'ðŸ‡¯ðŸ‡²',
    'ðŸ‡¯ðŸ‡´',
    'ðŸ‡¯ðŸ‡µ',
    'ðŸ‡°ðŸ‡ª',
    'ðŸ‡°ðŸ‡¬',
    'ðŸ‡°ðŸ‡­',
    'ðŸ‡°ðŸ‡®',
    'ðŸ‡°ðŸ‡²',
    'ðŸ‡°ðŸ‡³',
    'ðŸ‡°ðŸ‡µ',
    'ðŸ‡°ðŸ‡·',
    'ðŸ‡°ðŸ‡¼',
    'ðŸ‡°ðŸ‡¾',
    'ðŸ‡°ðŸ‡¿',
    'ðŸ‡±ðŸ‡¦',
    'ðŸ‡±ðŸ‡§',
    'ðŸ‡±ðŸ‡¨',
    'ðŸ‡±ðŸ‡®',
    'ðŸ‡±ðŸ‡°',
    'ðŸ‡±ðŸ‡·',
    'ðŸ‡±ðŸ‡¸',
    'ðŸ‡±ðŸ‡¹',
    'ðŸ‡±ðŸ‡º',
    'ðŸ‡±ðŸ‡»',
    'ðŸ‡±ðŸ‡¾',
    'ðŸ‡²ðŸ‡¦',
    'ðŸ‡²ðŸ‡¨',
    'ðŸ‡²ðŸ‡©',
    'ðŸ‡²ðŸ‡ª',
    'ðŸ‡²ðŸ‡«',
    'ðŸ‡²ðŸ‡¬',
    'ðŸ‡²ðŸ‡­',
    'ðŸ‡²ðŸ‡°',
    'ðŸ‡²ðŸ‡±',
    'ðŸ‡²ðŸ‡²',
    'ðŸ‡²ðŸ‡³',
    'ðŸ‡²ðŸ‡´',
    'ðŸ‡²ðŸ‡µ',
    'ðŸ‡²ðŸ‡¶',
    'ðŸ‡²ðŸ‡·',
    'ðŸ‡²ðŸ‡¸',
    'ðŸ‡²ðŸ‡¹',
    'ðŸ‡²ðŸ‡º',
    'ðŸ‡²ðŸ‡»',
    'ðŸ‡²ðŸ‡¼',
    'ðŸ‡²ðŸ‡½',
    'ðŸ‡²ðŸ‡¾',
    'ðŸ‡²ðŸ‡¿',
    'ðŸ‡³ðŸ‡¦',
    'ðŸ‡³ðŸ‡¨',
    'ðŸ‡³ðŸ‡ª',
    'ðŸ‡³ðŸ‡«',
    'ðŸ‡³ðŸ‡¬',
    'ðŸ‡³ðŸ‡®',
    'ðŸ‡³ðŸ‡±',
    'ðŸ‡³ðŸ‡´',
    'ðŸ‡³ðŸ‡µ',
    'ðŸ‡³ðŸ‡·',
    'ðŸ‡³ðŸ‡º',
    'ðŸ‡³ðŸ‡¿',
    'ðŸ‡´ðŸ‡²',
    'ðŸ‡µðŸ‡¦',
    'ðŸ‡µðŸ‡ª',
    'ðŸ‡µðŸ‡«',
    'ðŸ‡µðŸ‡¬',
    'ðŸ‡µðŸ‡­',
    'ðŸ‡µðŸ‡°',
    'ðŸ‡µðŸ‡±',
    'ðŸ‡µðŸ‡²',
    'ðŸ‡µðŸ‡³',
    'ðŸ‡µðŸ‡·',
    'ðŸ‡µðŸ‡¸',
    'ðŸ‡µðŸ‡¹',
    'ðŸ‡µðŸ‡¼',
    'ðŸ‡µðŸ‡¾',
    'ðŸ‡¶ðŸ‡¦',
    'ðŸ‡·ðŸ‡ª',
    'ðŸ‡·ðŸ‡´',
    'ðŸ‡·ðŸ‡¸',
    'ðŸ‡·ðŸ‡º',
    'ðŸ‡·ðŸ‡¼',
    'ðŸ‡¸ðŸ‡¦',
    'ðŸ‡¸ðŸ‡§',
    'ðŸ‡¸ðŸ‡¨',
    'ðŸ‡¸ðŸ‡©',
    'ðŸ‡¸ðŸ‡ª',
    'ðŸ‡¸ðŸ‡¬',
    'ðŸ‡¸ðŸ‡­',
    'ðŸ‡¸ðŸ‡®',
    'ðŸ‡¸ðŸ‡¯',
    'ðŸ‡¸ðŸ‡°',
    'ðŸ‡¸ðŸ‡±',
    'ðŸ‡¸ðŸ‡²',
    'ðŸ‡¸ðŸ‡³',
    'ðŸ‡¸ðŸ‡´',
    'ðŸ‡¸ðŸ‡·',
    'ðŸ‡¸ðŸ‡¸',
    'ðŸ‡¸ðŸ‡¹',
    'ðŸ‡¸ðŸ‡»',
    'ðŸ‡¸ðŸ‡½',
    'ðŸ‡¸ðŸ‡¾',
    'ðŸ‡¸ðŸ‡¿',
    'ðŸ‡¹ðŸ‡¦',
    'ðŸ‡¹ðŸ‡¨',
    'ðŸ‡¹ðŸ‡©',
    'ðŸ‡¹ðŸ‡«',
    'ðŸ‡¹ðŸ‡¬',
    'ðŸ‡¹ðŸ‡­',
    'ðŸ‡¹ðŸ‡¯',
    'ðŸ‡¹ðŸ‡°',
    'ðŸ‡¹ðŸ‡±',
    'ðŸ‡¹ðŸ‡²',
    'ðŸ‡¹ðŸ‡³',
    'ðŸ‡¹ðŸ‡´',
    'ðŸ‡¹ðŸ‡·',
    'ðŸ‡¹ðŸ‡¹',
    'ðŸ‡¹ðŸ‡»',
    'ðŸ‡¹ðŸ‡¼',
    'ðŸ‡¹ðŸ‡¿',
    'ðŸ‡ºðŸ‡¦',
    'ðŸ‡ºðŸ‡¬',
    'ðŸ‡ºðŸ‡²',
    'ðŸ‡ºðŸ‡³',
    'ðŸ‡ºðŸ‡¸',
    'ðŸ‡ºðŸ‡¾',
    'ðŸ‡ºðŸ‡¿',
    'ðŸ‡»ðŸ‡¦',
    'ðŸ‡»ðŸ‡¨',
    'ðŸ‡»ðŸ‡ª',
    'ðŸ‡»ðŸ‡¬',
    'ðŸ‡»ðŸ‡®',
    'ðŸ‡»ðŸ‡³',
    'ðŸ‡»ðŸ‡º',
    'ðŸ‡¼ðŸ‡«',
    'ðŸ‡¼ðŸ‡¸',
    'ðŸ‡½ðŸ‡°',
    'ðŸ‡¾ðŸ‡ª',
    'ðŸ‡¾ðŸ‡¹',
    'ðŸ‡¿ðŸ‡¦',
    'ðŸ‡¿ðŸ‡²',
    'ðŸ‡¿ðŸ‡¼',
  ],
};

const EditIcon = ({ onBack }: { onBack: () => void }) => {
  const { changeAccountIcon } = useWallet();
  const { selectedAccountId } = useEditAccountStore();
  const { accounts, getAccountWalletObject } = useWalletStore();
  const [selectedEmoji, setSelectedEmoji] = useState<string>('');
  const [activeCategory, setActiveCategory] =
    useState<string>('Smileys & People');
  const [selectionType, setSelectionType] = useState<string>(
    ICON_SELECTION_TYPES.EMOJI
  );
  const [hlProfile, setHlProfile] = useState<HLProfile | null>(null);
  const [loadingProfile, setLoadingProfile] = useState<boolean>(false);

  // Get account and wallet info
  const account = accounts.find(account => account.id === selectedAccountId);
  const accountWallet = selectedAccountId
    ? getAccountWalletObject(selectedAccountId)
    : null;

  // Get the first available address from the wallet object
  const accountAddress =
    accountWallet?.eip155?.address ||
    accountWallet?.solana?.address ||
    accountWallet?.sui?.address;

  // Fetch HL profile if account has an address
  useEffect(() => {
    let isMounted = true;
    if (accountAddress) {
      setLoadingProfile(true);
      getHLProfileByAddress(accountAddress).then(profile => {
        if (isMounted) {
          setHlProfile(profile);
          setLoadingProfile(false);
        }
      });
    } else {
      setHlProfile(null);
      setLoadingProfile(false);
    }
    return () => {
      isMounted = false;
    };
  }, [accountAddress]);

  const handleEmojiSelect = (emoji: string) => {
    setSelectedEmoji(emoji);
    setSelectionType(ICON_SELECTION_TYPES.EMOJI);
  };

  const handleHLAvatarSelect = () => {
    if (hlProfile?.avatar) {
      setSelectedEmoji(''); // Clear emoji selection
      setSelectionType(ICON_SELECTION_TYPES.HL_AVATAR);
    }
  };

  const handleSave = async () => {
    if (!selectedAccountId) return;

    try {
      if (
        selectionType === ICON_SELECTION_TYPES.HL_AVATAR &&
        hlProfile?.avatar
      ) {
        await changeAccountIcon(selectedAccountId, hlProfile.avatar);
      } else if (
        selectionType === ICON_SELECTION_TYPES.EMOJI &&
        selectedEmoji
      ) {
        await changeAccountIcon(selectedAccountId, selectedEmoji);
      }
      onBack();
    } catch (error) {
      console.error('Failed to update account icon:', error);
    }
  };

  const hasSelection =
    (selectionType === ICON_SELECTION_TYPES.EMOJI && selectedEmoji) ||
    (selectionType === ICON_SELECTION_TYPES.HL_AVATAR && hlProfile?.avatar);

  return (
    <DialogWrapper>
      <DialogHeader title="Edit Icon" onClose={onBack} />
      <DialogContent>
        {/* Selection type tabs - only show if HL avatar is available */}
        {hlProfile?.avatar && (
          <div className="flex gap-2">
            <button
              onClick={() => setSelectionType(ICON_SELECTION_TYPES.EMOJI)}
              className={`px-4 py-2 rounded-lg text-sm transition-colors ${
                selectionType === ICON_SELECTION_TYPES.EMOJI
                  ? 'bg-[var(--primary-color)] text-white'
                  : 'bg-[var(--background-color)] text-gray-400 hover:text-white'
              }`}
            >
              {SELECTION_TAB_LABELS.EMOJI}
            </button>
            <button
              onClick={() => setSelectionType(ICON_SELECTION_TYPES.HL_AVATAR)}
              className={`px-4 py-2 rounded-lg text-sm transition-colors ${
                selectionType === ICON_SELECTION_TYPES.HL_AVATAR
                  ? 'bg-[var(--primary-color)] text-white'
                  : 'bg-[var(--background-color)] text-gray-400 hover:text-white'
              }`}
            >
              {SELECTION_TAB_LABELS.HL_AVATAR}
            </button>
          </div>
        )}

        {/* Content based on selection type */}
        {selectionType === ICON_SELECTION_TYPES.HL_AVATAR ? (
          <div className="text-center py-8">
            {loadingProfile ? (
              <div className="flex flex-col items-center gap-2">
                <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--primary-color)]"></div>
                <p className="text-sm text-gray-400">Loading HL profile...</p>
              </div>
            ) : hlProfile?.avatar ? (
              <div className="flex flex-col items-center gap-4">
                <div
                  onClick={handleHLAvatarSelect}
                  className={`cursor-pointer p-4 rounded-lg transition-all hover:bg-[var(--background-color)]/50 hover:scale-105 ${
                    selectionType === ICON_SELECTION_TYPES.HL_AVATAR
                      ? 'bg-[var(--primary-color)]/20 ring-2 ring-[var(--primary-color)]'
                      : ''
                  }`}
                >
                  <img
                    src={hlProfile.avatar}
                    alt="HL Avatar"
                    className="size-20 rounded-full object-cover mx-auto"
                  />
                </div>
                <div className="flex items-center gap-2">
                  <HlNameIcon className="size-5" />
                  <p className="text-base font-medium">
                    {hlProfile.primaryName || 'Your HL Avatar'}
                  </p>
                </div>
                <p className="text-sm text-gray-400">
                  Click to select this as your account icon
                </p>
              </div>
            ) : (
              <div className="flex flex-col items-center gap-2">
                <HlNameIcon className="size-12 text-gray-400" />
                <p className="text-sm text-gray-400">
                  No HL avatar found for this address
                </p>
              </div>
            )}
          </div>
        ) : (
          <>
            {/* Category tabs for emoji selection */}
            <div className="flex flex-wrap gap-2 mb-4">
              {Object.keys(emojiCategories).map(category => (
                <button
                  key={category}
                  onClick={() => setActiveCategory(category)}
                  className={`px-3 py-2 rounded-lg text-sm transition-colors ${
                    activeCategory === category
                      ? 'bg-[var(--primary-color)] text-white'
                      : 'bg-[var(--background-color)] text-gray-400 hover:text-white'
                  }`}
                >
                  {category}
                </button>
              ))}
            </div>

            {/* Emoji grid */}
            <div className="grid grid-cols-8 gap-2">
              {emojiCategories[
                activeCategory as keyof typeof emojiCategories
              ].map((emoji, index) => (
                <button
                  key={`${activeCategory}-${index}`}
                  onClick={() => handleEmojiSelect(emoji)}
                  className={`w-10 h-10 flex items-center justify-center text-2xl rounded-lg transition-all hover:bg-[var(--background-color)]/50 hover:scale-110 ${
                    selectedEmoji === emoji &&
                    selectionType === ICON_SELECTION_TYPES.EMOJI
                      ? 'bg-[var(--primary-color)]/20 ring-2 ring-[var(--primary-color)]'
                      : ''
                  }`}
                >
                  {emoji}
                </button>
              ))}
            </div>
          </>
        )}
      </DialogContent>
      <DialogFooter>
        <Button
          onClick={handleSave}
          disabled={!hasSelection}
          className={`w-full ${
            !hasSelection ? 'opacity-50 cursor-not-allowed' : ''
          }`}
        >
          Save
        </Button>
      </DialogFooter>
    </DialogWrapper>
  );
};

export default EditIcon;
